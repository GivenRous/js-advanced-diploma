/*! For license information please see main.js.LICENSE.txt */
(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,r(o.key),o)}}function r(e){var r=function(e,r){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,"string");if("object"!=t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(r)?r:r+""}function n(t,e,r){var n=null,o=new Set,a=e;"move"===r&&(n=t.character.moveDistance),"attack"===r&&(n=t.character.attackDistance);for(var i=a,c=a,s=a,l=a,u=a,f=a,h=a,y=a,p=0;p<n;p+=1)i>=8&&(i-=8,o.add(i)),c>=8&&c%8!=7&&(c-=7,o.add(c)),s%8!=7&&(s+=1,o.add(s)),l<=Math.pow(8,2)-8&&l%8!=7&&(l+=9,o.add(l)),u<=Math.pow(8,2)-8&&(u+=8,o.add(u)),f<=Math.pow(8,2)-8&&f%8!=0&&(f+=7,o.add(f)),h%8!=0&&(h-=1,o.add(h)),y>8&&y%8!=0&&(y-=9,o.add(y));if("attack"===r)for(var v=Math.floor(i/8),m=Math.floor(u/8),d=h%8,b=s%8,w=v;w<=m;w+=1)for(var g=d;g<=b;g+=1)o.add(8*w+g);return Array.from(o)}var o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return r=t,n=[{key:"compMoveRange",value:function(t,e,r){t.forEach((function(t){e.forEach((function(e){e===t&&r.push(e)}))}))}},{key:"getRandomNumber",value:function(t){return Math.floor(Math.random()*t)}},{key:"isPlayableCharacter",value:function(t){return"bowman"===t.character.type||"magician"===t.character.type||"swordsman"===t.character.type}},{key:"levelUp",value:function(e){var r=e;return r.level+=1,t.levelUpAttackDefence(r),r.health+=80,r.health>100&&(r.health=100),Math.round(r.health),r}},{key:"levelUpAttackDefence",value:function(t){var e=t;return e.attack=Math.round(Math.max(e.attack,e.attack*(80+e.health)/100)),e.defence=Math.round(Math.max(e.defence,e.defence*(80+e.health)/100)),e}},{key:"statsUpdate",value:function(t,e,r){var n=document.querySelector(".level"),o=document.querySelector(".points"),a=document.querySelector(".best-points");n.innerText=t,o.innerText=e,a.innerText=r}}],null&&e(r.prototype,null),n&&e(r,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}();function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function i(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=c(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return i=t.done,t},e:function(t){s=!0,a=t},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}function c(t,e){if(t){if("string"==typeof t)return s(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(t,e):void 0}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,u(n.key),n)}}function u(t){var e=function(t,e){if("object"!=a(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==a(e)?e:e+""}var f=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.boardSize=8,this.container=null,this.boardEl=null,this.cells=[],this.cellClickListeners=[],this.cellEnterListeners=[],this.cellLeaveListeners=[],this.newGameListeners=[],this.saveGameListeners=[],this.loadGameListeners=[]},e=[{key:"bindToDOM",value:function(t){if(!(t instanceof HTMLElement))throw new Error("container is not HTMLElement");this.container=t}},{key:"drawUi",value:function(t){var e,r,n,o,a,i=this;this.checkBinding(),this.container.innerHTML='\n      <div class="controls">\n        <button data-id="action-restart" class="btn">New Game</button>\n        <button data-id="action-save" class="btn">Save Game</button>\n        <button data-id="action-load" class="btn">Load Game</button>\n      </div>\n        <div class="stats">\n            <span class="stats-name">Level: <span class="level"></span></span>\n            <span class="stats-name">Ponts: <span class="points"></span></span>\n            <span class="stats-name">Best points: <span class="best-points"></span></span>  \n        </div>\n      <div class="board-container">\n        <div data-id="board" class="board"></div>\n      </div>\n    ',this.newGameEl=this.container.querySelector("[data-id=action-restart]"),this.saveGameEl=this.container.querySelector("[data-id=action-save]"),this.loadGameEl=this.container.querySelector("[data-id=action-load]"),this.newGameEl.addEventListener("click",(function(t){return i.onNewGameClick(t)})),this.saveGameEl.addEventListener("click",(function(t){return i.onSaveGameClick(t)})),this.loadGameEl.addEventListener("click",(function(t){return i.onLoadGameClick(t)})),this.boardEl=this.container.querySelector("[data-id=board]"),this.boardEl.classList.add(t);for(var c=0;c<Math.pow(this.boardSize,2);c+=1){var s=document.createElement("div");s.classList.add("cell","map-tile","map-tile-".concat((e=c,void 0,void 0,void 0,n=(r=this.boardSize)-1,o=Math.pow(r,2)-r,a=Math.pow(r,2)-1,0===e?"top-left":e===n?"top-right":e>0&&e<n?"top":e===o?"bottom-left":e===a?"bottom-right":e>o&&e<a?"bottom":e%r==0?"left":e%r===n?"right":"center")),c),s.addEventListener("mouseenter",(function(t){return i.onCellEnter(t)})),s.addEventListener("mouseleave",(function(t){return i.onCellLeave(t)})),s.addEventListener("click",(function(t){return i.onCellClick(t)})),this.boardEl.appendChild(s)}this.cells=Array.from(this.boardEl.children)}},{key:"redrawPositions",value:function(t){var e,r=i(this.cells);try{for(r.s();!(e=r.n()).done;)e.value.innerHTML=""}catch(t){r.e(t)}finally{r.f()}var n,o,a=i(t);try{for(a.s();!(n=a.n()).done;){var c=n.value,s=this.boardEl.children[c.position],l=document.createElement("div");l.classList.add("character",c.character.type);var u=document.createElement("div");u.classList.add("health-level");var f=document.createElement("div");f.classList.add("health-level-indicator","health-level-indicator-".concat((o=c.character.health)<15?"critical":o<50?"normal":"high")),f.style.width="".concat(c.character.health,"%"),u.appendChild(f),l.appendChild(u),s.appendChild(l)}}catch(t){a.e(t)}finally{a.f()}}},{key:"addCellEnterListener",value:function(t){this.cellEnterListeners.push(t)}},{key:"addCellLeaveListener",value:function(t){this.cellLeaveListeners.push(t)}},{key:"addCellClickListener",value:function(t){this.cellClickListeners.push(t)}},{key:"addNewGameListener",value:function(t){this.newGameListeners.push(t)}},{key:"addSaveGameListener",value:function(t){this.saveGameListeners.push(t)}},{key:"addLoadGameListener",value:function(t){this.loadGameListeners.push(t)}},{key:"onCellEnter",value:function(t){t.preventDefault();var e=this.cells.indexOf(t.currentTarget);this.cellEnterListeners.forEach((function(t){return t.call(null,e)}))}},{key:"onCellLeave",value:function(t){t.preventDefault();var e=this.cells.indexOf(t.currentTarget);this.cellLeaveListeners.forEach((function(t){return t.call(null,e)}))}},{key:"onCellClick",value:function(t){var e=this.cells.indexOf(t.currentTarget);this.cellClickListeners.forEach((function(t){return t.call(null,e)}))}},{key:"onNewGameClick",value:function(t){t.preventDefault(),this.newGameListeners.forEach((function(t){return t.call(null)}))}},{key:"onSaveGameClick",value:function(t){t.preventDefault(),this.saveGameListeners.forEach((function(t){return t.call(null)}))}},{key:"onLoadGameClick",value:function(t){t.preventDefault(),this.loadGameListeners.forEach((function(t){return t.call(null)}))}},{key:"selectCell",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"yellow";this.deselectCell(t),this.cells[t].classList.add("selected","selected-".concat(e))}},{key:"deselectCell",value:function(t){var e,r,n=this.cells[t];(e=n.classList).remove.apply(e,function(t){if(Array.isArray(t))return s(t)}(r=Array.from(n.classList).filter((function(t){return t.startsWith("selected")})))||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(r)||c(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())}},{key:"showCellTooltip",value:function(t,e){this.cells[e].title=t}},{key:"hideCellTooltip",value:function(t){this.cells[t].title=""}},{key:"showDamage",value:function(t,e){var r=this;return new Promise((function(n){var o=r.cells[t],a=document.createElement("span");a.textContent=e,a.classList.add("damage"),o.appendChild(a),a.addEventListener("animationend",(function(){o.removeChild(a),n()}))}))}},{key:"setCursor",value:function(t){this.boardEl.style.cursor=t}},{key:"checkBinding",value:function(){if(null===this.container)throw new Error("GamePlay not bind to DOM")}}],r=[{key:"showError",value:function(t){alert(t)}},{key:"showMessage",value:function(t){alert(t)}}],e&&l(t.prototype,e),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();const h="auto",y="pointer",p="crosshair",v="not-allowed";function m(t){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}function d(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,b(n.key),n)}}function b(t){var e=function(t,e){if("object"!=m(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=m(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==m(e)?e:e+""}var w=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.bestPoints=0,this.gameData=null},(e=[{key:"saveBestPoints",value:function(t){t>this.bestPoints&&(this.bestPoints=t)}},{key:"saveDataGame",value:function(t){return this.gameData={level:t.level,turn:t.turn,points:t.points,userTeam:t.userTeam,compTeam:t.compTeam,characters:t.characters},this.gameData}}])&&d(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function g(t){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(t)}function P(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,C(n.key),n)}}function E(t,e,r){return e&&P(t.prototype,e),r&&P(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function C(t){var e=function(t,e){if("object"!=g(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=g(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==g(e)?e:e+""}var S=E((function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"generic";if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.level=e,this.attack=0,this.defence=0,this.health=50,this.type=r,"Character"===(this instanceof t?this.constructor:void 0).name)throw new Error("You cant create a Character class")}));function k(t){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},k(t)}function O(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,j(n.key),n)}}function L(t,e,r){return e&&O(t.prototype,e),r&&O(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function j(t){var e=function(t,e){if("object"!=k(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=k(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==k(e)?e:e+""}var T=L((function t(e,r){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),!(e instanceof S))throw new Error("character must be instance of Character or its children");if("number"!=typeof r)throw new Error("position must be a number");this.character=e,this.position=r}));function x(t){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},x(t)}function _(){_=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function u(t,e,r,n){var a=e&&e.prototype instanceof d?e:d,i=Object.create(a.prototype),c=new G(n||[]);return o(i,"_invoke",{value:O(t,r,c)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var h="suspendedStart",y="suspendedYield",p="executing",v="completed",m={};function d(){}function b(){}function w(){}var g={};l(g,i,(function(){return this}));var P=Object.getPrototypeOf,E=P&&P(P(M([])));E&&E!==r&&n.call(E,i)&&(g=E);var C=w.prototype=d.prototype=Object.create(g);function S(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,a,i,c){var s=f(t[o],t,a);if("throw"!==s.type){var l=s.arg,u=l.value;return u&&"object"==x(u)&&n.call(u,"__await")?e.resolve(u.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(u).then((function(t){l.value=t,i(l)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function O(e,r,n){var o=h;return function(a,i){if(o===p)throw Error("Generator is already running");if(o===v){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=L(c,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var l=f(e,r,n);if("normal"===l.type){if(o=n.done?v:y,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=v,n.method="throw",n.arg=l.arg)}}}function L(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,L(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var a=f(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function G(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function M(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(x(e)+" is not iterable")}return b.prototype=w,o(C,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:b,configurable:!0}),b.displayName=l(w,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,l(t,s,"GeneratorFunction")),t.prototype=Object.create(C),t},e.awrap=function(t){return{__await:t}},S(k.prototype),l(k.prototype,c,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new k(u(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},S(C),l(C,s,"Generator"),l(C,i,(function(){return this})),l(C,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=M,G.prototype={constructor:G,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:M(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}var G=_().mark(M);function M(t,e,r){var n,o;return _().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=Math.floor(Math.random()*t.length),o=Math.floor(Math.random()*(r+1-e)+e),a.next=5,new t[n](o);case 5:a.next=0;break;case 7:case"end":return a.stop()}}),G)}function D(t,e,r,n){for(var o=[],a=M(t,e,r),i=0;i<n;i+=1)o.push(a.next().value);return o}function A(t){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A(t)}function I(t,e,r){return e=R(e),function(t,e){if(e&&("object"===A(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,N()?Reflect.construct(e,r||[],R(t).constructor):e.apply(t,r))}function N(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(N=function(){return!!t})()}function R(t){return R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},R(t)}function U(t,e){return U=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},U(t,e)}var B=function(t){function e(t){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"bowman";if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=I(this,e,[t,n]),"bowman"!==n)throw new Error("Некорректный тип персонажа");return r.type=n,r.attack=25,r.defence=25,r.attackDistance=2,r.moveDistance=2,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&U(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(S);function F(t){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},F(t)}function q(t,e,r){return e=Y(e),function(t,e){if(e&&("object"===F(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,z()?Reflect.construct(e,r||[],Y(t).constructor):e.apply(t,r))}function z(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(z=function(){return!!t})()}function Y(t){return Y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Y(t)}function H(t,e){return H=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},H(t,e)}var W=function(t){function e(t){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"magician";if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=q(this,e,[t,n]),"magician"!==n)throw new Error("Некорректный тип персонажа");return r.type=n,r.attack=10,r.defence=40,r.attackDistance=4,r.moveDistance=1,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&H(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(S);function J(t){return J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},J(t)}function V(t,e,r){return e=K(e),function(t,e){if(e&&("object"===J(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,$()?Reflect.construct(e,r||[],K(t).constructor):e.apply(t,r))}function $(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return($=function(){return!!t})()}function K(t){return K=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},K(t)}function Q(t,e){return Q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Q(t,e)}var X=function(t){function e(t){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"swordsman";if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=V(this,e,[t,n]),"swordsman"!==n)throw new Error("Некорректный тип персонажа");return r.type=n,r.attack=40,r.defence=10,r.attackDistance=1,r.moveDistance=4,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Q(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(S);function Z(t){return Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Z(t)}function tt(t,e,r){return e=rt(e),function(t,e){if(e&&("object"===Z(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,et()?Reflect.construct(e,r||[],rt(t).constructor):e.apply(t,r))}function et(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(et=function(){return!!t})()}function rt(t){return rt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},rt(t)}function nt(t,e){return nt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},nt(t,e)}var ot=function(t){function e(t){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"daemon";if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=tt(this,e,[t]),"daemon"!==n)throw new Error("Некорректный тип персонажа");return r.type=n,r.attack=10,r.defence=10,r.attackDistance=4,r.moveDistance=1,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&nt(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(S);function at(t){return at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},at(t)}function it(t,e,r){return e=st(e),function(t,e){if(e&&("object"===at(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ct()?Reflect.construct(e,r||[],st(t).constructor):e.apply(t,r))}function ct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(ct=function(){return!!t})()}function st(t){return st=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},st(t)}function lt(t,e){return lt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},lt(t,e)}var ut=function(t){function e(t){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"undead";if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=it(this,e,[t]),"undead"!==n)throw new Error("Некорректный тип персонажа");return r.type=n,r.attack=40,r.defence=10,r.attackDistance=1,r.moveDistance=4,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&lt(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(S);function ft(t){return ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ft(t)}function ht(t,e,r){return e=pt(e),function(t,e){if(e&&("object"===ft(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,yt()?Reflect.construct(e,r||[],pt(t).constructor):e.apply(t,r))}function yt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(yt=function(){return!!t})()}function pt(t){return pt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},pt(t)}function vt(t,e){return vt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},vt(t,e)}var mt=function(t){function e(t){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"vampire";if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=ht(this,e,[t]),"vampire"!==n)throw new Error("Некорректный тип персонажа");return r.type=n,r.attack=25,r.defence=25,r.attackDistance=2,r.moveDistance=2,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&vt(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(S);function dt(t){return dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dt(t)}function bt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,wt(n.key),n)}}function wt(t){var e=function(t,e){if("object"!=dt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=dt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==dt(e)?e:e+""}function gt(t,e,r){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,r)}function Pt(t,e){return t.get(function(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}(t,e))}var Et=new WeakMap,Ct=new WeakMap,St=new WeakMap,kt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),gt(this,Et,[B,X]),gt(this,Ct,[B,X,W]),gt(this,St,[ot,ut,mt]),this.characters=null},(e=[{key:"playerStartTeam",value:function(){this.characters=D(Pt(Et,this),1,1,2)}},{key:"loadGameTeam",value:function(t){var e=this;this.characters=[],t.forEach((function(t){var r=t.type[0].toUpperCase()+t.type.slice(1),n=e.createClass(r,t.level);n.attack=t.attack,n.defence=t.defence,n.health=t.health,e.characters.push(n)}))}},{key:"createClass",value:function(t,e){switch(t){case"Bowman":return new B(e);case"Swordsman":return new X(e);case"Magician":return new W(e);case"Daemon":return new ot(e);case"Undead":return new ut(e);case"Vampire":return new mt(e)}return!1}},{key:"compStartTeam",value:function(){this.characters=D(Pt(St,this),1,1,2)}},{key:"playerUpdateTeam",value:function(t,e){var r=this,n=1,o=0,a=0;if(2===t&&(o=1,a=1),3===t&&(o=2,a=2),4===t&&(o=2,a=3),t>4){if(n=t-4,6===e&&(o=1),e<=5&&(o=2),e>6)return!1;a=t}return D(Pt(Ct,this),n,a,o).forEach((function(t){r.updatesCharacteristics(t),r.characters.push(t)})),this.characters}},{key:"compUpdateTeam",value:function(t,e){var r=this,n=1;t>4&&(n=t-4),this.characters=D(Pt(St,this),n,t,e),this.characters.forEach((function(t){r.updatesCharacteristics(t)}))}},{key:"updatesCharacteristics",value:function(t){if(t.level>1)for(var e=1;e<t.level;e+=1)o.levelUpAttackDefence(t)}}])&&bt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();const Ot={1:"prairie",2:"desert",3:"arctic",4:"mountain"};function Lt(t){return Lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lt(t)}function jt(){jt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function u(t,e,r,n){var a=e&&e.prototype instanceof d?e:d,i=Object.create(a.prototype),c=new x(n||[]);return o(i,"_invoke",{value:O(t,r,c)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var h="suspendedStart",y="suspendedYield",p="executing",v="completed",m={};function d(){}function b(){}function w(){}var g={};l(g,i,(function(){return this}));var P=Object.getPrototypeOf,E=P&&P(P(_([])));E&&E!==r&&n.call(E,i)&&(g=E);var C=w.prototype=d.prototype=Object.create(g);function S(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,a,i,c){var s=f(t[o],t,a);if("throw"!==s.type){var l=s.arg,u=l.value;return u&&"object"==Lt(u)&&n.call(u,"__await")?e.resolve(u.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(u).then((function(t){l.value=t,i(l)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function O(e,r,n){var o=h;return function(a,i){if(o===p)throw Error("Generator is already running");if(o===v){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=L(c,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var l=f(e,r,n);if("normal"===l.type){if(o=n.done?v:y,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=v,n.method="throw",n.arg=l.arg)}}}function L(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,L(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var a=f(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function x(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function _(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Lt(e)+" is not iterable")}return b.prototype=w,o(C,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:b,configurable:!0}),b.displayName=l(w,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,l(t,s,"GeneratorFunction")),t.prototype=Object.create(C),t},e.awrap=function(t){return{__await:t}},S(k.prototype),l(k.prototype,c,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new k(u(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},S(C),l(C,s,"Generator"),l(C,i,(function(){return this})),l(C,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=_,x.prototype={constructor:x,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:_(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function Tt(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function xt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){Tt(a,n,o,i,c,"next",t)}function c(t){Tt(a,n,o,i,c,"throw",t)}i(void 0)}))}}function _t(t){return function(t){if(Array.isArray(t))return Gt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Gt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Gt(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Mt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Dt(n.key),n)}}function Dt(t){var e=function(t,e){if("object"!=Lt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=Lt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Lt(e)?e:e+""}var At=function(){return t=function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.gamePlay=e,this.stateService=r,this.gameState=new w,this.cleanGameProperty()},(e=[{key:"init",value:function(){this.gamePlay.drawUi(Ot[this.level]),this.gamePlay.addNewGameListener(this.newGame.bind(this)),this.gamePlay.addSaveGameListener(this.saveGame.bind(this)),this.gamePlay.addLoadGameListener(this.loadGame.bind(this)),this.addCellListeners(),this.startGame()}},{key:"addCellListeners",value:function(){this.gamePlay.addCellEnterListener(this.onCellEnter.bind(this)),this.gamePlay.addCellLeaveListener(this.onCellLeave.bind(this)),this.gamePlay.addCellClickListener(this.onCellClick.bind(this))}},{key:"startGame",value:function(){o.statsUpdate(this.level,this.points,this.gameState.bestPoints),this.userTeam.playerStartTeam(),this.compTeam.compStartTeam(),this.setCharactersArr(),this.gamePlay.redrawPositions(this.characters)}},{key:"newGame",value:function(){this.cleanGameProperty(),this.gamePlay.drawUi(Ot[this.level]),this.clearCellListeners(),this.addCellListeners(),this.startGame()}},{key:"saveGame",value:function(){this.gameState.saveDataGame(this),this.stateService.save(this.gameState),f.showError("Игра сохранена")}},{key:"loadGame",value:function(){var t=this;if(0!==this.stateService.storage.length){var e=this.stateService.load();this.cleanGameProperty(),this.level=e.gameData.level,this.points=e.gameData.points,this.gamePlay.drawUi(Ot[this.setTheme()]),this.userTeam.loadGameTeam(e.gameData.userTeam.characters),this.compTeam.loadGameTeam(e.gameData.compTeam.characters),[].concat(_t(this.userTeam.characters),_t(this.compTeam.characters)).forEach((function(r,n){t.characters.push(new T(r,e.gameData.characters[n].position))})),this.clearCellListeners(),this.addCellListeners(),this.gamePlay.redrawPositions(this.characters),o.statsUpdate(this.level,this.points,this.gameState.bestPoints),f.showError("Игра загружена")}else f.showError("Нет сохранений")}},{key:"onCellClick",value:function(t){var e=this,r=this.checkCharacterInCell(t);if(r&&o.isPlayableCharacter(r)&&((this.activeCharacterIndex||0===this.activeCharacterIndex)&&this.gamePlay.deselectCell(this.activeCharacterIndex),this.gamePlay.selectCell(t),this.activeCharacterIndex=t,this.activeCharacter=r),r&&!o.isPlayableCharacter(r)){if(!this.canAttack)return this.activeCharacter?void f.showError("Противник слишком далеко"):void f.showError("Это персонаж противника");if(!this.activeCharacter)return;var n=+Math.max(this.activeCharacter.character.attack-r.character.defence,.1*this.activeCharacter.character.attack).toFixed(1);r.character.health-=n,r.character.health=+r.character.health.toFixed(1),this.gamePlay.deselectCell(this.activeCharacterIndex),this.gamePlay.deselectCell(t),this.activeCharacterIndex=null,this.activeCharacter=null,this.canAttack=null,this.gamePlay.setCursor(h),xt(jt().mark((function o(){return jt().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,e.gamePlay.showDamage(t,n);case 2:r.character.health<=0&&e.death(e.compTeam,r),e.gamePlay.redrawPositions(e.characters),e.turn=!1,e.compTeam.characters.length>0?e.whoseTurn():setTimeout((function(){e.gameLoop()}),100);case 6:case"end":return o.stop()}}),o)})))()}r||null==this.canMove||(this.gamePlay.deselectCell(this.activeCharacter.position),this.activeCharacter.position=t,this.canMove=null,this.activeCharacterIndex=null,this.activeCharacter=null,this.gamePlay.deselectCell(t),this.gamePlay.setCursor(h),this.gamePlay.redrawPositions(this.characters),this.turn=!1,this.whoseTurn())}},{key:"onCellEnter",value:function(t){var e=this,r=this.checkCharacterInCell(t);r&&(o.isPlayableCharacter(r)&&this.gamePlay.setCursor(y),this.gamePlay.showCellTooltip("🎖 ".concat(r.character.level," ⚔ ").concat(r.character.attack," 🛡 ").concat(r.character.defence," ❤ ").concat(r.character.health),t)),this.activeCharacter&&!r&&(n(this.activeCharacter,this.activeCharacterIndex,"move").forEach((function(r){r===t&&(e.gamePlay.selectCell(t,"green"),e.gamePlay.setCursor(y),e.canMove=r)})),this.activeCharacter&&!this.canMove&&this.gamePlay.setCursor(v)),this.activeCharacter&&r&&!o.isPlayableCharacter(r)&&(n(this.activeCharacter,this.activeCharacterIndex,"attack").forEach((function(r){r===t&&(e.gamePlay.selectCell(t,"red"),e.gamePlay.setCursor(p),e.canAttack=!0)})),this.canAttack||o.isPlayableCharacter(r)||this.gamePlay.setCursor(v))}},{key:"onCellLeave",value:function(t){var e=this.checkCharacterInCell(t);this.gamePlay.setCursor(h),e&&this.gamePlay.hideCellTooltip(t),this.activeCharacter&&!e&&(this.gamePlay.deselectCell(t),this.canMove=null),this.activeCharacter&&e&&!o.isPlayableCharacter(e)&&(this.gamePlay.deselectCell(t),this.canAttack=null)}},{key:"turnComp",value:function(){var t=this,e=null,r=null;if(this.compTeam.characters.find((function(a){var i=t.characters.find((function(t){return t.character===a}));if(n(i,i.position,"attack").find((function(e){var n=t.checkCharacterInCell(e);return!(!n||!o.isPlayableCharacter(n))&&(r=n)})),r){e=i,t.gamePlay.selectCell(e.position),t.gamePlay.selectCell(r.position,"red");var c=+Math.max(e.character.attack-r.character.defence,.1*e.character.attack).toFixed(1);return r.character.health-=c,r.character.health=+r.character.health.toFixed(1),xt(jt().mark((function n(){return jt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.gamePlay.showDamage(r.position,c);case 2:t.gamePlay.deselectCell(e.position),t.gamePlay.deselectCell(r.position),r.character.health<=0&&t.death(t.userTeam,r),t.gamePlay.redrawPositions(t.characters),t.turn=!0,0===t.userTeam.characters.length&&setTimeout((function(){f.showError("GAME OVER"),t.clearCellListeners()}),100);case 8:case"end":return n.stop()}}),n)})))(),e}return!1})),!e){var a=n(e=this.strongCharacter(this.compTeam.characters),e.position,"move");a.forEach((function(e,r,n){t.checkCharacterInCell(e)&&n.splice(r,1)}));var i=new Set;this.userTeam.characters.find((function(r){var o=t.characters.find((function(t){return t.character===r}));return n(e,o.position,"attack").forEach((function(t){i.add(t)})),!1}));var c=[];o.compMoveRange(i,a,c),0===c.length&&(i.forEach((function(r){t.userTeam.characters.forEach((function(){n(e,r,"attack").forEach((function(t){i.add(t)}))}))})),o.compMoveRange(i,a,c)),e.position=c[0],this.gamePlay.redrawPositions(this.characters),this.turn=!0}}},{key:"death",value:function(t,e){t.characters.forEach((function(t,r,n){t===e.character&&n.splice(r,1)})),this.characters.forEach((function(t,r,n){t.character===e.character&&n.splice(r,1)}))}},{key:"gameLoop",value:function(){var t=this;this.userTeam.characters.forEach((function(e){t.points+=e.health,t.points=+t.points.toFixed(1),t.gameState.saveBestPoints(t.points),t.updateBestPoints(),o.levelUp(e)})),f.showError("Вы победили! Очки: ".concat(this.points)),this.level+=1,this.turn=!0,this.gamePlay.drawUi(Ot[this.setTheme()]),this.userTeam.playerUpdateTeam(this.level,this.userTeam.characters.length),this.compTeam.compUpdateTeam(this.level,this.userTeam.characters.length),this.characters=[],this.allowPlayerPositions=[],this.allowCompPositions=[],this.setCharactersArr(),this.gamePlay.redrawPositions(this.characters),o.statsUpdate(this.level,this.points,this.gameState.bestPoints),this.whoseTurn()}},{key:"clearCellListeners",value:function(){this.gamePlay.cellEnterListeners=[],this.gamePlay.cellLeaveListeners=[],this.gamePlay.cellClickListeners=[]}},{key:"cleanGameProperty",value:function(){this.level=1,this.turn=!0,this.points=0,this.userTeam=new kt,this.compTeam=new kt,this.allowPlayerPositions=[],this.allowCompPositions=[],this.characters=[],this.activeCharacterIndex=null,this.activeCharacter=null,this.canAttack=null,this.canMove=null}},{key:"strongCharacter",value:function(t){var e=t;return e.length>1&&e.sort((function(t,e){return t.attack>e.attack?-1:1})),this.characters.find((function(t){return t.character===e[0]}))}},{key:"checkCharacterInCell",value:function(t){return this.characters.find((function(e){return e.position===t}))}},{key:"generatePositions",value:function(t,e){var r=this;t.characters.forEach((function(t){var n=o.getRandomNumber(e.length),a=e[n];e.splice(n,1),r.characters.push(new T(t,a))}))}},{key:"setCharactersArr",value:function(){this.getPlayerPositions(),this.getCompPositions(),this.generatePositions(this.userTeam,this.allowPlayerPositions),this.generatePositions(this.compTeam,this.allowCompPositions)}},{key:"getPlayerPositions",value:function(){for(var t=0;t<Math.pow(this.gamePlay.boardSize,2);)t%2==0?(this.allowPlayerPositions.push(t),t+=1):(this.allowPlayerPositions.push(t),t+=7)}},{key:"getCompPositions",value:function(){for(var t=6;t<Math.pow(this.gamePlay.boardSize,2);)t%2==0?(this.allowCompPositions.push(t),t+=1):(this.allowCompPositions.push(t),t+=7)}},{key:"setTheme",value:function(){var t=this.level%4;return 0===t&&(t=4),t}},{key:"updateBestPoints",value:function(){if(0!==this.stateService.storage.length){var t=this.stateService.load();this.gameState.bestPoints>t.bestPoints&&(t.bestPoints=this.gameState.bestPoints,this.stateService.save(t))}}},{key:"whoseTurn",value:function(){this.turn||this.turnComp()}}])&&Mt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function It(t){return It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},It(t)}function Nt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Rt(n.key),n)}}function Rt(t){var e=function(t,e){if("object"!=It(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=It(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==It(e)?e:e+""}var Ut=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.storage=e},(e=[{key:"save",value:function(t){this.storage.setItem("state",JSON.stringify(t))}},{key:"load",value:function(){try{return JSON.parse(this.storage.getItem("state"))}catch(t){throw new Error("Invalid state")}}}])&&Nt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}(),Bt=new f;Bt.bindToDOM(document.querySelector("#game-container")),new At(Bt,new Ut(localStorage)).init()})();